# dotbot config
- defaults:
    link:
      create: true
      relink: false

- clean: ["~"]

- create:
    - ~/bin
    - ~/tmp
    - ~/.vim/undo-history
    - ~/.config/git
    - ~/.config/lvim
    - ~/.config/awesome
    - ~/.config/direnv
    - ~/.config/nixpkgs
    # - ~/.ssh:
    #   mode: 0700

- link:
    ~/.tmux.conf: tmux.conf
    ~/.config/git/ignore: gitignore
    ~/.gitconfig: gitconfig
    ~/.ssh/config: sshconfig
    ~/.config/lvim/config.lua: lvim.config.lua
    ~/.config/awesome/rc.lua: x/awesome/rc.lua
    ~/.config/direnv/direnvrc: zsh/direnvrc
    ~/.config/nixpkgs/home.nix: home.nix

- shell:
    - [git submodule update --init --recursive, Installing submodules]
    - description: create gitconfig
      command: |
        [ -e ~/.config/git/gitconfig ] ||\
        echo -e '[include]\npath = .dotfiles/gitconfig' > ~/.config/git/gitconfig
    - description: create zshrc
      command: |
        [ -e ~/.zshrc ] || echo 'source ~/.dotfiles/zsh/zshrc' > ~/.zshrc
    - description: install nix
      command: which nix-env || curl -L https://nixos.org/nix/install | sh
    - description: install home-manager
      command: |
        export NIX_PATH=$HOME/.nix-defexpr/channels:/nix/var/nix/profiles/per-user/root/channels${NIX_PATH:+:$NIX_PATH}
        nix-channel --add https://github.com/nix-community/home-manager/archive/master.tar.gz home-manager
        nix-channel --update
        nix-shell '<home-manager>' -A install
